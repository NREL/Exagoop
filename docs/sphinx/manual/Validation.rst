
ExaGOOP utilizes the formulation outlined in the previous section. This section presents three validation and verification test cases using ExaGOOP.

Axial vibration of an elastic bar
---------------------------------

In this test case, the free, axial vibration of a continuum bar made of a linearly elastic material is studied. This is one of the test cases for which the exact solution is known.

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 100%;">
       <img src="../landing/_images/AxBar_PDT.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> The physical domain of the bar</p>
     </div>
     <div style="flex: 0 0 100%;">
       <img src="../landing/_images/AxBar_PDMPM.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong> Modeling of the bar in ExaGOOP</p>
     </div>
   </div>
.. figure:: ../landing/_images/none.png
   :name: fig-axbar
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
            
   Axial vibration of a bar. (a) Configuration of test case (b) Corresponding MPM model. Gray lines indicate the background Eulerian grid, and the gray circles are the material points located at time t = 0.
   

The test case configuration is shown in :numref:`fig-axbar` (a). The bar has a length :math:`L` with an area of cross-section :math:`A` and is made up of a linear elastic material with Young’s modulus :math:`E`. The Poisson’s ratio of the material is set as zero. The bar is fixed at one end and left free at the other. The equation governing the vibration of the bar is given by,

.. math:: :label: goveq_axial_bar

   \begin{aligned}
       \frac{\partial^2 u}{\partial t^2}=c^2 \frac{\partial^2 u}{\partial x^2}   
   \end{aligned}

where :math:`u` is the axial displacement and :math:`c` is the speed of
sound in the elastic medium. The bar is subjected to the following
boundary conditions:

.. math:: :label: bc_axial_bar

   \begin{aligned}
       u(0,t)=0\\
       \frac{\partial u}{\partial x} (L,t) = 0
   \end{aligned}

When an initial axial velocity :math:`v(x,0)= V_0 \sin \left(\frac{\pi x}{2 L}\right)` is imposed on the bar, the analytical solution to the governing equation Eq :eq:`goveq_axial_bar` subjected to the boundary conditions Eqs. :eq:`bc_axial_bar` is given by,

.. math::

   \begin{aligned}
   & u(x, t)=\frac{V_0}{\omega_1} \sin \left(\frac{\pi x}{2 L}\right) \sin \left(\omega_1 t\right) \\
   & v(x, t)=V_0 \sin \left(\frac{\pi x}{2 L}\right) \cos \left(\omega_1 t\right)
   \end{aligned}

where :math:`\omega_1` is the fundamental frequency of the first mode of
vibration.

Numerical simulations of this test case are performed using ExaGOOP. The properties of the bar are set as :math:`E=100, L=25` and :math:`V_0 = 0.1`. The density of the material, :math:`\rho` is set equal to unity. The length of the bar is discretized using :math:`25` material points located equidistant from each other so that each material point simulates one unit length of the bar. Even though this test case involves only one-dimension in space, a three-dimensional, structured background grid with unit grid length is generated by ExaGOOP . The grid has :math:`29` cells in the axial direction and three cells in the other two directions. At the initial time, each material point is located at the center of the cell as shown in :numref:`fig-axbar` (b). Four grid cells are left as a buffer region between the right-most material point and the right boundary of the background grid. No-slip and slip wall boundary conditions are imposed on the left and the right boundaries, respectively, while periodic boundary conditions are imposed in the other two directions. Simulations are performed using both the linear-hat shape functions as well as the cubic B-spline shape functions, and for :math:`\alpha_{P-F}` equal to zero and one, respectively. The CFL numbers are varied across different simulations. For ease of presentation, the comparisons between the exact solution and the MPM solutions obtained using are shown here using the center of mass velocity of the bar, :math:`v_{cm}` and using system energies. The exact center of mass velocity is given by :math:`v_{\mathrm{cm}}^{\mathrm{exa}}(t)=\frac{V_0 c}{\omega_1 L} \cos \left(\omega_1 t\right)` and its MPM counterpart is calculated as :math:`v_{\mathrm{cm}}^{\mathrm{num}}(t)=\frac{\sum v_p(t) m_p}{\sum m_p}`. Three different forms of system energy is shown for comparison, namely the kinetic energy (:math:`KE=\frac{1}{2} \sum_{p=1}^{n_p} \mathbf{v}_p \cdot \mathbf{v}_p m_p`), the strain energy (:math:`SE=\frac{1}{2} \sum_{p=1}^{n_p} \sigma_{p} \epsilon_{p} V_p`) and the total energy (:math:`TE=KE+SE`).

Effect of :math:`\alpha_{P-F}`
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/AVB_Effect_of_alpha_Vel_1Order_a=0.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> alpha=0</p>
     </div>
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/AVB_Effect_of_alpha_Vel_1Order_a=1.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong> alpha=1</p>
     </div>
   </div>
.. figure:: ../landing/_images/none.png
   :name: fig-axbar-effofalpha
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Effect of :math:`\alpha_{P-F}` on the center of mass velocity of the axial bar
   
   
:numref:`fig-axbar-effofalpha` shows the  variation of :math:`v_{cm}` as a function of time for two different values of :math:`\alpha_{P-F}` (:math:`0` and :math:`1`). It is observed that for :math:`\alpha_{P-F}=0`, the center of mass velocity decreases with time in contrast to the exact solution where the amplitude remains unchanged. On the other hand, for :math:`\alpha_{P-F}=1` the exact nature of the solution is well captured by ExaGOOP solution.


This dissipative nature of the numerical solution at low values of :math:`\alpha_{P-F}` can also be observed from the temporal evolution of
energies plotted in :numref:`fig-axbar-effofalpha-energy`. Both kinetic and strain energy (and hence the total energy as well) is found
to decrease and ultimately reach zero with time for :math:`\alpha_{P-F}=0` while :math:`\alpha_{P-F}=1` captures the non-dissipative nature of the exact solution accurately.

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/AVB_Effect_of_alpha_Engy_1Order_a=0.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> alpha=0</p>
     </div>
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/AVB_Effect_of_alpha_Engy_1Order_a=1.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong> alpha=1</p>
     </div>
   </div>
.. figure:: ../landing/_images/none.png
   :name: fig-axbar-effofalpha-energy
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Effect of :math:`\alpha_{P-F}` on the kinetic (KE), strain (SE) and total (TE) of the axial bar
   
Effect of :math:`CFL`
~~~~~~~~~~~~~~~~~~~~~

It is also interesting to study the effect of :math:`CFL` on the solution accuracy. :numref:`fig-axbar-effofcfl` shows the time evolution of :math:`v_{cm}` for values of :math:`CFL=0.01,0.1` and :math:`0.5`. The results shown are obtained using the cubic spline shape functions and for :math:`\alpha_{P-F}=0`. It is observed that the magnitude of :math:`v_{cm}` reduces over time for this numerical parameters.  It is also observed that the MPM solution deviates from the exact solution as the :math:`CFL` is reduced. The solution is observed to be more dissipative as the CFL number is reduced. Results obtained using the linear hat shape functions also show a similar trend and hence are not shown here.

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 32%;">
       <img src="../landing/_images/AVB_Effect_of_CFL_Vel_3Order_a=0_CFL_0p01.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> CFL=0.01</p>
     </div>
     <div style="flex: 0 0 32%;">
       <img src="../landing/_images/AVB_Effect_of_CFL_Vel_3Order_a=0_CFL_0p1.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong> CFL=0.1</p>
     </div>
     <div style="flex: 0 0 32%;">
       <img src="../landing/_images/AVB_Effect_of_CFL_Vel_3Order_a=0_CFL_0p5.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong> CFL=0.5</p>
     </div>
   </div>
.. figure:: ../landing/_images/none.png
   :name: fig-axbar-effofcfl
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Effect of :math:`CFL` on the center of mass velocity of the axial bar (alpha=0)

On the contrary, very minimal deviations from the exact solution are observed for all :math:`CFL` numbers for :math:`\alpha_{P-F}=1` as shown
in :numref:`fig-axbar-effofcfl_a1`. This again highlights the significance of chosing a high value of :math:`\alpha_{P-F}` (0.9-1.0) for accurate simulations. This trend also holds for the solution computed using the linear hat shape functions.

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 32%;">
       <img src="../landing/_images/AVB_Effect_of_CFL_Vel_3Order_a=1_CFL_0p01.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> CFL=0.01</p>
     </div>
     <div style="flex: 0 0 32%;">
       <img src="../landing/_images/AVB_Effect_of_CFL_Vel_3Order_a=1_CFL_0p1.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong> CFL=0.1</p>
     </div>
     <div style="flex: 0 0 32%;">
       <img src="../landing/_images/AVB_Effect_of_CFL_Vel_3Order_a=1_CFL_0p5.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong> CFL=0.5</p>
     </div>
   </div>
.. figure:: ../landing/_images/none.png
   :name: fig-axbar-effofcfl_a1
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Effect of :math:`CFL` on the center of mass velocity of the axial bar (alpha=1)

Hence, it is concluded that lower values of :math:`\alpha_{P-F}` lead to dissipative solution. The dissipative nature further worsens with smaller
values of CFL number. Hence, for all MPM simulations a typical value of :math:`\alpha_{P-F}=0.95-1.0` is suggested.

Collision of two-dimensional elastic disks
------------------------------------------

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 32%;">
       <img src="../landing/_images/EDC_PDT.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> </p>
     </div>
     <div style="flex: 0 0 32%;">
       <img src="../landing/_images/EDC_PDMPM.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong></p>
     </div>     
   </div>
.. figure:: ../landing/_images/none.png
   :name: f-edc
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Elastic collision of two circular disks. (a) Problem definition (b) ExaGOOP models

This test case is used to verify ExaGOOP's capability to simulate problems involving contact detection. The two-dimensional test case configuration is
shown in :numref:`f-edc` (a) and consists of two elastic disks, each of radius :math:`r` and separated by a distance :math:`d`. At time :math:`t=0`, both the disks have a velocity :math:`v` and are directed towards each other. As time progresses, both disks approach each other at constant velocity and collide. After collision, the disks rebound and move away from each other. Since the collision is elastic, the total energy of the disks remains constant in time.

For simulating this test case in ExaGOOP, the value of Young’s modulus :math:`E` and density :math:`\rho` is chosen as :math:`1000`. The
Poisson's ratio is set as 0.3. The radius of the disks is set to 0.2 m each and the disks are separated by a distance of :math:`d=0.6\sqrt{2}` m.
The background grid is a square of side :math:`L=2`\ m and consists of 20 cells each in the x and y directions. The two disks are modeled
using linear elastic material points with four material points located inside each cell. Simulations are carried out using both the linear hat and the
cubic B-spline shape functions. Based on the conclusions from the previous test case, the value of CFL and :math:`\alpha_{P-F}` are chosen as 0.1
and 0.95, respectively.

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/EDC1.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> </p>
     </div>
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/EDC2.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong></p>
     </div>     
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/EDC3.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong></p>
     </div>     
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/EDC4.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong></p>
     </div>     
   </div>
.. figure:: ../landing/_images/none.png
   :name: f-edc-coll
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Various stages of disks motion and collision simulated using ExaGOOP

:numref:`f-edc-coll` (a) and (b) show the approach of the disks towards each other. :numref:`f-edc-coll` (c) shows the instant at which the disks collide and :numref:`f-edc-coll` (d) shows the disks rebounding after collision.

:numref:`f-edc-energy` (a) and (b) show the time evolution of the energies of both disks simulated using linear hat and cubic B-spline shape functions. From the initial time until the moment of collision, only kinetic energy exists for both disks due to their initial velocities.

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/EDC_Energy_LH.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> </p>
     </div>
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/EDC_Energy_CS.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong></p>
     </div>     
   </div>
.. figure:: ../landing/_images/none.png
   :name: f-edc-energy
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Time evolution of kinetic, strain and total energies of both the disks


Once the disks collide, a portion of the total energy is converted to strain energy. Since there are no dissipative mechanisms modeled in this
problem, the total energy of the disks should be conserved. Both the linear hat and the cubic spline shape function are able to recover the
total energy completely. A temporary loss of total energy is observed during the time of collision. This is due to the mass lumping algorithm
adopted which tend to make the solution slightly dissipative. The exact time of contact happens at time :math:`t=1.58`\ sec while the numerical
simulations tend to predict the contact much early. This is because, the contact in MPM occurs through the background grid nodes and not through
material points. This inaccuracy can be reduced by refining the background grid further.

Dam break simulation
--------------------

ExaGOOP's capability in simulating fluids is demonstrated using the 2-D dam break test case. The test case consists of an initial column of
water of height :math:`H_0` and width :math:`L_0` located inside a square domain, as shown in :numref:`f-dambreak-compdom` (a). When :math:`t=0`, the water column is released, allowing it to flow downward due to gravity. Over time, the water gradually fills the entire domain. Experimental measurements of the water front are available :cite:`martin1952` for comparison with MPM results.

For the MPM simulations, the domain is structured as shown in :numref:`f-dambreak-compdom` (b). A square domain with a side length of 0.4m is selected to create the background grid, which is discretized into 100 cells in each direction. The height of the water column is set at 0.2 m, and the width is 0.1 m. Unlike previous test cases discussed, water is treated as a fluid, necessitating the specification of an appropriate equation of state. In this study, water is modelled using a barotopic equation of state that relates pressure to the density of water as,

.. math::

   \begin{aligned}
   p=\kappa\left[\left(\frac{\rho}{\rho_0}\right)^\gamma-1\right]
   \end{aligned}

The value of :math:`\kappa` and :math:`\gamma` is set as 20000 and 7.0 respectively. The density of water is initialised as 1000 kg/m3.
Simulation is performed using :math:`CFL=0.1` and :math:`\alpha_{P-F}=0.95`. The spatial discretization scheme employed is cubic B-spline. The simulation snapshots at various time intervals are shown in :numref:`f-dambreak-sim`.

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/DB_PDT.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> </p>
     </div>
     <div style="flex: 0 0 45%;">
       <img src="../landing/_images/DB1.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b)</strong></p>
     </div>     
   </div>
.. figure:: ../landing/_images/none.png
   :name: f-dambreak-compdom
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Two-dimensional dam break test case (a) the physical problem definition and (b) the corresponding MPM model

:numref:`f-dambreak-mpm_exp` presents a comparison of the water front calculated using ExaGOOP and the experimentally obtained water front values
:cite:`martin1952` at various times. The solid line indicates the ExaGOOP solution and the red circles denote the experimental data from :cite:`martin1952`. A strong correlation is observed between the numerical and experimental values, thereby validating the solver.

.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 23%;">
       <img src="../landing/_images/DB1.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a) t = 0.0 s</strong> </p>
     </div>
     <div style="flex: 0 0 23%;">
       <img src="../landing/_images/DB2.png" alt="Outlet Jet" style="width: 100%;">
       <p style="text-align: center;"><strong>(b) t = 0.15 s</strong></p>
     </div>     
     <div style="flex: 0 0 23%;">
       <img src="../landing/_images/DB3.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(c) t = 0.22 s</strong> </p>
     </div>
     <div style="flex: 0 0 23%;">
       <img src="../landing/_images/DB4.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(d) t = 0.29 s</strong> </p>
     </div>
   </div>
.. figure:: ../landing/_images/none.png
   :name: f-dambreak-sim
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Evolution of water front in the 2-D dam break test case
   
.. raw:: html

   <div class="figure-grid" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
     <div style="flex: 0 0 50%;">
       <img src="../landing/_images/DB_Res2.png" alt="Inlet Flow" style="width: 100%;">
       <p style="text-align: center;"><strong>(a)</strong> </p>
     </div>   
   </div>
.. figure:: ../landing/_images/none.png
   :name: f-dambreak-mpm_exp
   :height: 0
   :width: 0   
   :figwidth: 100%
   :align: center   
   :alt: Simulation Snapshots Overview
   
   Comparison of the water front location with time. Solid line shows ExaGOOP solution and red circles indicate experimental data from :cite:`martin1952`


